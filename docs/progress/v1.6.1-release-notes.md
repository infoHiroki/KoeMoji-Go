# v1.6.1 リリースノート

**リリース日**: 2025-01-22
**バージョン**: 1.6.1

---

## 🎉 概要

v1.6.1 は、Windows GUI の日本語フォント表示問題を修正し、配布ファイル名の命名規則を改善したパッチリリースです。

---

## 🐛 バグ修正

### Windows GUI 日本語文字化け問題の修正

**問題**: Windows環境で KoeMoji-Go の GUI を起動すると、全ての日本語テキストが文字化けしていた

**症状**:
- ステータスラベルが `���` や `□□□` と表示される
- ファイル数、タイミング情報などの全てのテキストが判読不能
- ログエリアのテキストも文字化け

**根本原因**:
Fyne v2.6.1 フレームワークのバグで、Windows環境において `TextStyle{Bold: true}` と日本語文字の組み合わせがフォント描画エラーを引き起こしていた

**修正内容**:
- [internal/gui/window.go](../../internal/gui/window.go): ラベル初期化時の Bold スタイル削除
- [internal/gui/components.go](../../internal/gui/components.go): ラベル更新時の Bold スタイル再適用削除

**影響範囲**: Windows のみ（macOS、Linux は影響なし）

**検証状況**: コード修正済み、外部テスター確認待ち

詳細: [v1.6.0-windows-gui-font-fix.md](v1.6.0-windows-gui-font-fix.md)

---

## 🔧 改善

### ビルド成果物の命名規則変更

**問題**: 従来の命名規則（`-win.zip` 形式）がアンチウイルスソフトの誤検知を引き起こしていた

**変更内容**:

| 項目 | 変更前 | 変更後 |
|------|-------|-------|
| **Windows版** | `KoeMoji-Go-v1.6.0-win.zip` | `koemoji-go-1.6.1-windows.zip` |
| **macOS版** | `KoeMoji-Go-v1.6.0-mac.tar.gz` | `koemoji-go-1.6.1-macos.tar.gz` |
| **解凍フォルダ** | `KoeMoji-Go-v1.6.0/` | `koemoji-go-1.6.1/` |

**変更理由**:
1. **セキュリティソフト対応**: "-win" サフィックスがマルウェアと誤認されるケースがある
2. **一貫性**: 全て小文字、プラットフォーム名を明確に（`windows`, `macos`）
3. **シンプル化**: "v" プレフィックスを削除、よりクリーンな命名

**影響を受けるファイル**:
- [build/windows/build.bat](../../build/windows/build.bat)（4箇所）
- [build/macos/build.sh](../../build/macos/build.sh)（4箇所）
- [.gitignore](../../.gitignore)（新パターン追加）

---

## 📚 ドキュメント追加

### macOS ビルドガイドの作成

新規ドキュメント: [docs/developer/MACOS_BUILD_GUIDE.md](../developer/MACOS_BUILD_GUIDE.md)

**内容**:
- macOS 環境でのビルド前提条件
- PortAudio、Go、Python のセットアップ手順
- ビルドスクリプトの使用方法
- トラブルシューティング（Gatekeeper、マイク権限など）
- リリース成果物の配布方法

**目的**:
Mac でのビルド作業を標準化し、再現性を確保

---

## 📦 ダウンロード

### Windows 版

**ファイル名**: `koemoji-go-1.6.1-windows.zip`

**内容**:
```
koemoji-go-1.6.1/
├── koemoji-go.exe           # 実行ファイル
├── libportaudio.dll         # PortAudio ライブラリ
├── libgcc_s_seh-1.dll       # GCC ランタイム
├── libstdc++-6.dll          # C++ ランタイム
├── libwinpthread-1.dll      # pthread ライブラリ
├── config.json              # 設定ファイル（サンプル）
└── README.md                # リリースノート
```

**インストール手順**:
1. ZIP を解凍
2. `koemoji-go.exe` をダブルクリック
3. 初回起動時に `config.json` を編集

### macOS 版

**ファイル名**: `koemoji-go-1.6.1-macos.tar.gz`

**内容**:
```
koemoji-go-1.6.1/
├── koemoji-go               # 実行ファイル（Apple Silicon）
├── config.json              # 設定ファイル（サンプル）
└── README.md                # リリースノート
```

**インストール手順**:
1. tar.gz を解凍: `tar -xzf koemoji-go-1.6.1-macos.tar.gz`
2. 実行権限付与（必要に応じて）: `chmod +x koemoji-go-1.6.1/koemoji-go`
3. Gatekeeper 対策: `xattr -cr koemoji-go-1.6.1/`
4. 起動: `./koemoji-go`

---

## 🔄 アップグレードガイド

### v1.6.0 から v1.6.1 へ

**データ移行**:

既存の設定ファイル（`config.json`）はそのまま使用可能です。

```bash
# 1. 古いバージョンのディレクトリから config.json をコピー
cp KoeMoji-Go-v1.6.0/config.json koemoji-go-1.6.1/

# 2. 処理済みアーカイブもコピー（必要に応じて）
cp -r KoeMoji-Go-v1.6.0/archive koemoji-go-1.6.1/
```

**互換性**: v1.6.0 と完全に互換性があります

---

## ✅ 修正された問題

| Issue | 説明 | 影響 |
|-------|------|------|
| Windows GUI 文字化け | Bold スタイルによる日本語描画エラー | Windows のみ |
| アンチウイルス誤検知 | "-win" サフィックスが疑わしいと判定される | Windows ユーザー |

---

## 🧪 テスト状況

### 修正確認済み

- ✅ ビルドスクリプトの動作（Windows/macOS）
- ✅ バージョン番号の正確性（`--version` コマンド）
- ✅ 配布ファイル名の命名規則
- ✅ .gitignore の新パターン対応

### 外部テスト待ち

- ⏳ Windows GUI での日本語表示確認
- ⏳ アンチウイルスソフトでの誤検知テスト
- ⏳ macOS での実機ビルド確認

---

## 📝 既知の問題

現時点で既知の問題はありません。

バグを発見された場合は、GitHub Issues でご報告ください：
https://github.com/hirokitakamura/koemoji-go/issues

---

## 🔗 関連ドキュメント

- [バージョン更新チェックリスト](../developer/VERSION_UPDATE_CHECKLIST.md)
- [macOS ビルドガイド](../developer/MACOS_BUILD_GUIDE.md)
- [Windows GUI フォント修正](v1.6.0-windows-gui-font-fix.md)
- [CLAUDE.md](../../CLAUDE.md)

---

## 👥 貢献者

- [@infoHiroki](https://github.com/infoHiroki) - 開発
- Claude Code - コード支援、ドキュメント作成

---

## 📄 ライセンス

個人利用自由、商用利用は作者に連絡してください。

---

**次回リリース予定**: v1.7.0（新機能追加）

**フィードバック**: [GitHub Issues](https://github.com/hirokitakamura/koemoji-go/issues)
