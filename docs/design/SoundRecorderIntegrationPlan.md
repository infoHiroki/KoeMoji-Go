# KoeMoji-Go 録音機能統合設計書

## プロジェクト概要

KoeMoji-Goへの録音機能統合により、録音→文字起こし→AI要約の完全なワークフローを実現する。

## 設計タスク一覧

### ✅ 完了済み

- [x] **基本分析**: SoundRecorderDesign.mdの要件分析完了
- [x] **アーキテクチャ調査**: 既存KoeMoji-Go構造の把握完了  
- [x] **統合計画**: 基本的な統合戦略の策定完了

### 🔴 高優先度 (即座に着手)

- [ ] **詳細アーキテクチャ設計**: 録音機能の既存システム統合方法を設計
  - 既存パッケージ構造への組み込み方法
  - 処理フロー（録音→保存→文字起こし）の設計
  - 既存のgoroutine管理との統合

- [ ] **設定管理設計**: 録音関連設定の構造とUI言語対応を設計
  - Config構造体への録音設定追加
  - 多言語対応（日本語/英語）メッセージ
  - 設定保存/読み込み処理

- [ ] **UI/UX設計**: TUI/GUIでの録音操作と状態表示を設計
  - TUIでの録音コントロール（キーバインド）
  - GUIでの録音ボタンとステータス表示
  - リアルタイム録音時間表示

- [ ] **ファイル管理設計**: 録音ファイルの命名規則と処理フローを設計
  - 録音ファイルの自動命名ルール
  - inputディレクトリへの自動配置
  - 一時ファイルとエラー時の処理

### 🟡 中優先度 (基本設計後に着手)

- [ ] **プラットフォーム対応設計**: macOS/Windows固有要件と依存関係を設計
  - PortAudio依存関係管理
  - プラットフォーム固有のデバイス検出
  - ビルド要件とクロスコンパイル対応

- [ ] **エラーハンドリング設計**: 録音エラーとログ統合を設計
  - 録音失敗時の適切なエラー処理
  - 既存ログシステムとの統合
  - ユーザーへのエラー通知方法

- [ ] **デバイス管理設計**: 音声デバイス選択と仮想デバイス検出を設計
  - デバイス一覧表示と選択UI
  - BlackHole/Stereo Mix自動検出
  - デバイス設定の永続化

- [ ] **統合ポイント設計**: 録音→文字起こしワークフローの連携を設計
  - 録音完了後の自動処理開始
  - 既存のファイル監視システムとの連携
  - 処理キューへの自動追加

### 🟢 低優先度 (詳細設計完了後)

- [ ] **実装計画書作成**: 段階的実装手順とマイルストーンを策定
  - Phase 1: 基本録音機能
  - Phase 2: UI統合
  - Phase 3: 高度な機能（デバイス選択等）
  - テスト計画とリリース戦略

## 設計原則

### 1. 既存システムとの調和
- 既存のアーキテクチャパターンを踏襲
- 設定管理の一貫性維持
- ログシステムの統一

### 2. ユーザビリティ
- 直感的な操作性（TUI/GUI両対応）
- 分かりやすいステータス表示
- エラー時の適切なガイダンス

### 3. 技術的安定性
- スレッドセーフな実装
- 適切なリソース管理
- プラットフォーム間の動作一貫性

### 4. 拡張性
- 将来的な機能追加への対応
- 設定項目の柔軟な拡張
- 新しい音声フォーマット対応

## 次のアクション

1. **高優先度タスクから順次着手**
2. **各設計段階でのレビューポイント設定**
3. **実装前の最終設計書統合**

---

*最終更新: 2025-06-20*
*ステータス: 設計フェーズ*