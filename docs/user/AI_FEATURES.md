# AI機能ガイド

KoeMoji-GoのAI要約機能について説明します。

## 📋 目次

- [AI要約機能について](#ai要約機能について)
- [初期設定](#初期設定)
- [使用方法](#使用方法)
- [設定項目詳細](#設定項目詳細)
- [プロンプトカスタマイズ](#プロンプトカスタマイズ)
- [トラブルシューティング](#トラブルシューティング)

## AI要約機能について

KoeMoji-Go v1.2.0で追加されたAI要約機能は、文字起こし完了後に自動的に内容を要約する機能です。

### 特徴
- **自動要約**: 文字起こし後に自動で要約生成
- **多言語対応**: 日本語・英語・その他言語の要約が可能
- **カスタマイズ可能**: 要約プロンプトをカスタマイズ可能
- **複数モデル対応**: GPT-4o、GPT-4-turbo、GPT-3.5-turbo

### 出力ファイル
文字起こしファイルと同じ場所に要約ファイルが作成されます：
- 文字起こし: `output/example.txt`
- 要約: `output/example_summary.txt`

## 初期設定

### 1. OpenAI APIキーの取得
1. [OpenAI Platform](https://platform.openai.com/)にアクセス
2. アカウント作成またはログイン
3. API KeysページでAPIキーを生成
4. APIキーをコピー（後で使用）

### 2. KoeMoji-Goでの設定
1. KoeMoji-Goを起動
2. `c`キーで設定画面を開く
3. **LLMタブ**を選択
4. 以下の項目を設定：

#### 基本設定
- **項目12**: AI要約機能を「有効」に変更
- **項目13**: APIプロバイダー「openai」（デフォルト）
- **項目14**: OpenAI APIキーを入力
- **項目15**: 使用モデルを選択（gpt-4o推奨）

#### 詳細設定
- **項目16**: 最大トークン数（4096推奨）
- **項目17**: 要約プロンプトテンプレート
- **項目18**: 要約言語（auto推奨）

## 使用方法

### 自動要約の流れ
1. 音声・動画ファイルを`input/`フォルダに配置
2. 文字起こし処理が自動開始
3. 文字起こし完了後、AI要約が自動開始
4. 要約完了後、`output/`フォルダに保存

### 手動での要約確認
要約生成の状況は以下で確認できます：
- **ログ表示**: `l`キーでログ確認
- **ファイル確認**: `o`キーで出力フォルダを開く

## 設定項目詳細

### AI要約設定項目

| 項目 | 設定名 | 説明 | 推奨値 |
|------|--------|------|--------|
| 12 | llm_summary_enabled | AI要約機能の有効/無効 | true |
| 13 | llm_api_provider | APIプロバイダー | openai |
| 14 | llm_api_key | OpenAI APIキー | （取得したキー） |
| 15 | llm_model | 使用モデル | gpt-4o |
| 16 | llm_max_tokens | 最大トークン数 | 4096 |
| 17 | summary_prompt_template | 要約プロンプト | （下記参照） |
| 18 | summary_language | 要約言語 | auto |

### モデル選択ガイド

#### gpt-4o（推奨）
- **特徴**: 最新・高性能・コストパフォーマンス良好
- **用途**: 一般的な要約作業
- **料金**: 中程度

#### gpt-4-turbo
- **特徴**: 高性能・長文対応
- **用途**: 長時間録音・複雑な内容
- **料金**: 高め

#### gpt-3.5-turbo
- **特徴**: 高速・低コスト
- **用途**: シンプルな要約・大量処理
- **料金**: 安価

## プロンプトカスタマイズ

### デフォルトプロンプト
```
以下の文字起こしテキストを{language}で要約してください。重要なポイントを箇条書きでまとめ、全体の概要も含めてください。

{text}
```

### カスタマイズ変数
- `{text}`: 文字起こしテキスト（自動挿入）
- `{language}`: 要約言語（設定に応じて自動設定）

### カスタマイズ例

#### 会議録用
```
以下の会議の文字起こしを{language}で要約してください。
1. 主要な議題と決定事項
2. アクションアイテム（担当者・期限）
3. 次回までの宿題

{text}
```

#### 講義録用
```
以下の講義内容を{language}で要約してください。
1. 主要なトピック
2. 重要な概念・定義
3. 例示や事例
4. 覚えるべきポイント

{text}
```

#### インタビュー用
```
以下のインタビューを{language}で要約してください。
1. 話者の主要な発言
2. 重要な情報・データ
3. 印象的なエピソード

{text}
```

## トラブルシューティング

### APIキー関連

#### 「APIキーが無効」エラー
- OpenAI Platformでキーが有効か確認
- キーにスペースや改行が入っていないか確認
- 課金設定が有効になっているか確認

#### 「使用量制限」エラー
- OpenAI Platformで使用量・請求を確認
- 月次制限に達していないか確認
- 新しいAPIキーを生成して再設定

### 要約生成関連

#### 要約が生成されない
1. AI要約機能が有効になっているか確認（項目12）
2. APIキーが正しく設定されているか確認（項目14）
3. ログ（`l`キー）でエラーメッセージを確認
4. インターネット接続を確認

#### 要約の品質が悪い
1. より高性能なモデル（gpt-4o）に変更
2. プロンプトテンプレートをカスタマイズ
3. 最大トークン数を増加（項目16）

#### 要約が途中で切れる
- 最大トークン数（項目16）を増加
- 長い録音の場合は音声を分割

### 料金・コスト関連

#### 予想以上に料金がかかる
- 使用モデルをgpt-3.5-turboに変更
- 最大トークン数を削減
- 必要な音声のみ処理するように調整

#### コスト最適化のヒント
1. **短時間録音**: 5-10分程度に分割
2. **モデル選択**: 用途に応じてモデルを使い分け
3. **頻度調整**: 重要な録音のみAI要約を有効化

### ログでのエラー確認

AI要約関連のエラーは以下で確認できます：
```bash
# 実行中のログ表示
l キーを押す

# ログファイル直接確認
cat koemoji.log | grep -i "llm\|summary\|openai"
```

## 今後の拡張予定

### 計画中の機能
- **複数プロバイダー対応**: Anthropic Claude、Google Gemini等
- **要約スタイル選択**: 箇条書き、段落形式、表形式等
- **要約長さ調整**: 短文・中文・長文の選択
- **キーワード抽出**: 重要語句の自動抽出
- **多言語翻訳**: 要約と同時に翻訳機能

---

## 📞 サポート

AI機能に関する問題は、以下の情報と共にお問い合わせください：

1. 使用しているモデル名
2. エラーメッセージ（ログより）
3. 処理対象の音声ファイル長
4. OpenAI APIの課金状況